\documentclass[review]{elsarticle}

\usepackage{lineno,hyperref}
\modulolinenumbers[5]

\journal{Journal of \LaTeX\ Templates}
\usepackage{amssymb}
\usepackage{amsmath,amsthm}
\usepackage{float}
\usepackage{url}
\usepackage{setspace}
\usepackage{hyperref}
\usepackage{todonotes}
\usepackage{amsthm} 
\usepackage[ruled,vlined,linesnumbered]{algorithm2e} 
\usepackage{makecell}


\onehalfspacing
\usepackage{pdfpages}
\usepackage{times}
\usepackage{multirow}
\usepackage[toc,page]{appendix}
\usepackage{listings}
\newtheorem{lemma}{Lemma}
\newtheorem{definition}[lemma]{Definition}
\newtheorem{theorem}[lemma]{Theorem}
\newtheorem{claim}[lemma]{Claim}
\newtheorem{example}[lemma]{Example}
\newtheorem{proposition}[lemma]{Proposition}


\DeclareMathOperator{\supp}{support}
\DeclareMathOperator{\support}{support}
\DeclareMathOperator{\Trim}{Trim}
\DeclareMathOperator{\LTrim}{LTrim}

\begin{document}

\begin{definition}\label{consecutive} For a set $S \subseteq \mathbb{R}$ we say that
$B \subseteq S$ is \emph{consecutive} if any $s\in S$ that is smaller than $\max(B)$ and larger than $\min(B)$ is in $B$.
\end{definition}

\begin{definition}\label{part_consecutive} A partition $P=\{B_1,\dots,B_n\}$ of a set $S \subseteq \mathbb{R}$ is called 
\emph{consecutive} if all the subsets $B_1 ,\dots,B_n$ are consecutive.
\end{definition}


\begin{definition}\label{partition}
	For a discrete real random variable $X$ and a partition $P$ of its support, we define a new discrete random variable $X_P$ by:
	
	$$Pr(X_P = t) = \begin{cases} 
	Pr(X\in B) &  \text{if } t = min(B) \wedge  B \in P, \\
	0      & \text{otherwise.}
	\end{cases}$$
\end{definition}


\begin{definition}
	For discrete real-valued variables $X_1$ and $X_2$, we say that $X_2$ is a one-sided Kolmogorov approximation of $X_1$ with the parameters $\varepsilon$ and $m$, denoted by 
	$X_1 \preceq_{\varepsilon,m} X_2$, if $\forall t\colon 0 \leq   F_{X_2}(t)-F_{X_1}(t) \leq \varepsilon$ and $|\support(X_2)| \leq m$. 
	%We say that the approximation is \textbf{tight} if there exists no  $X_2' \neq X_2$ such that $X_1 \preceq_{\varepsilon,m} X_2'$ and, $\forall t$, $F_{X_2'}(t) \leq F_{X_2}(t)$. 
\end{definition}

\begin{proposition}
	For a discrete real-valued random variable $X$ and $m \in \mathbb{N}$, 
	let $\varepsilon = \min\{\varepsilon \colon \text{  $\exists X'$ such that $X \preceq_{\varepsilon,m} X'$}\}$ be the best possible approximation error for $X$ with a random variable whose support of size $m$. This same level of approximation can be obtained with a partition, i.e., there is consecutive partition $P$ of $\supp(X)$ such that $X \preceq_{\varepsilon,m} X_P$.
	
\end{proposition}

\begin{proof}
Let $X'$ be such that $X \preceq_{\varepsilon,m} X'$. Specifically, for all $t$,
\begin{equation}
F_{X}(t) \leq F_{X'}(T) \leq F_X(t)+\varepsilon
\label{*}
\end{equation}
Assume that $t_0,t_1,\dots,t_n$ are all the elements in the support of $X$ in ascending order. Define the random variable $X''$ by 
$$
f_{X''}(t) = \begin{cases}
Pr(X' \leq t_0)           & \text{if } t=t_0  \\ 
Pr(t_{i-1} < X' \leq t_i) & \text{if } t=t_i \text{ for some } i \neq 0 \\ 
0                         & \text{otherwise}
\end{cases}
$$
Since can we only assign a non-zero probability to $P_{X''}(t)$ if $t \in \support(X)$, we have that $\support(X'') \subseteq \support(X)$. We will show now that $F_{X}(t) \leq  F_{X''}(t) \leq F_{X'}(t)$ for all $t$. We will examine different $t$s as follows. 
\begin{description}
\item[For $t < t_0$:] $F_{X''}(t)=F_{X}(t)=0$. Since $F_{X'}(t) \geq 0$ for all $t$, we get that $F_{X}(t) \leq  F_{X''}(t) \leq F_{X'}(t)$.
\item[For $t=t_i$:] $F_{X'}(t)=F_{X''}(t)$ and $F_{X}(t) \leq F_{X'}(t)$ by \eqref{*}.
\item[For $t_{i-1} < t < t_i$:] $F_{X''}(t)= F_{X''}(t_{i-1})$ and $F_{X}(t)=F_{X}(t_{i-1})$. Since we already have that $F_{X}(t_{i-1}) \leq F_{X''}(t_{i-1}) \leq F_{X'}(t_{i-1})$, we get that $F_{X}(t) \leq F_{X''}(t) \leq F_{X'}(t_{i-1})$. By monotonicity of CDFs, $F_{X'}(t_{i-1}) \leq F_{X'}(t)$ therefore $F_{X}(t) \leq F_{X''}(t) \leq F_{X'}(t)$.
\item[For $t > t_n$:] $F_{X}(t)= F_{X''}(t)=1$ and, by~\eqref{*}, since CDFs are always smaller or equal to one, also $F_{X'}(t)=1$.

\end{description}


and (2) $X \preceq_{\varepsilon,m} X''$. 


Let $s_0,s_1,\dots,s_m$ be the elements in the support of $X''$ in ascending order. Define the random variable $X'''$
$$
Pr(X'''=t) = \begin{cases}
Pr(X \leq s_0)           & \text{if } t=s_0  \\ 
Pr(s_{i-1} < X \leq s_i) & \text{if } t=s_i \text{ for some } i \neq 0 \\ 
0                        & \text{otherwise}
\end{cases}
$$
We will show now that: (1) there is a partition $P$ such that $X'''=X_P$; (2) $X \preceq_{\varepsilon,m} X'''$. \todo{Add proofs of these claims}

%To Liat: Maybe we better define $X'''$ directly from $X'$ (without defining $X''$) by 
%	$$F_{X'''}(t)=\begin{cases}
%	  0    & \text{if } t < t_0 \\
%	  F_{X'}(t_i) & \text{if } t = t_i     \\
%	  F_{X'}(t_{i-1})    & \text{if } t_{i-1} < t < t_i \\
%	  1               & t \geq t_n
%	\end{cases}$$
\end{proof}


\begin{theorem}
Given $X_1 \dots X_k$ discrete random variables in a table representation and $m \in \mathbb{N}$, if $X'=OptimalTrim(X_1 \dots X_k,m)$, a discrete random variable and a partition of $X$ with a support of size $\leq m$ then $\max\limits_{t}|F_{\sum_1^k X_i}(t)-F_{X'}(t)|$ is minimal.
\end{theorem}

\begin{proof}
From Lemma~\ref{consecutive} we get that the optimal partition for the objective function $|F_{\sum_1^k X_i}(t)-F_{X'}(t)|$ is consecutive.
Using this fact allow us to reduce our problem to the same problem solved by Rothblum in the paper from 1982. Let $X = \sum_{i=1}^k X_i$, from Rothblum we first construct the weighted graph $G = (V,E)$, where $V = \support(X), E = \{\forall i,j \in V, (i,j)\in E\}$ and the weights $\forall e=(i,j)\in E, w(e) = |F_{X}(i)-F_{X}(j)|$. In a classical Rothblum the shortest path is found by Bellman Ford algorithm, in our case we use a variation of Bellman-Ford, minimax bottleneck path by using the function $bottleneck(x) =    min   [max(bottleneck(v),w(e))]$. Bellman-Ford algorithm can be forced to return path of some length, in our case $m$, meaning, find the lightest maximal edge in a length $m$ path. 
$X'$ is the result of $OptimalTrim(X_1 \dots X_n,m)$, which is the same as described above. 
\end{proof}

\begin{algorithm}
  \DontPrintSemicolon
  \SetKwFunction{Sequence}{Sequence} 
  \SetKwFunction{Convolv}{Conv}
  \SetKwFunction{Trim}{Trim}

   $D=((0,1))$ //  Dummy random var.: $0$ with prob. $1$ \;
  \For{$i=1$ \emph{\KwTo} $k$} {
	$D$=Convolve($D, X_i$)\; 
	}
   $G=(E,V)$ \;
   $V = \support(D)$\;
   $E = \{\forall i,j \in V, (i,j)\in E\}$\;
   \ForEach{$e=(i,j) \in  E $ }{
   $w(e) = F_D(i)+\sum_{t=i}^j P_D(t)-F_D(i)$
   }
   $L, \varepsilon$=BellmanFord($G$, $min(V)$, $m$, $bottleneck(x) =    min   [max(bottleneck(v),w(e))]$) /* Run Bellman-Ford algorithm as minimax bottleneck path version, $m$ times, starting with a single source, where $L$ is the path */ \;
   %http://www.cs.cmu.edu/afs/cs/academic/class/15451-f04/www/lectures/lect1012.txt
   $D'=()$\;
   \ForEach{$e=(i,j) \in  L $ }{
   $D' = append(D', (i,\sum_{t=i}^j P_D(t))$
   }
   \Return $D, bottleneck(x)$\;
  %-------------------------------%
  \SetKwProg{myproc}{Procedure}{}{}
  \myproc{
  BellmanFord($G$,$source$,$m$,$f$)
  }{ }
     
\caption{OptimalTrim ($X_1,\dots,X_k$ , $m$)}  
\label{alg:sequence}
\end{algorithm}


Two not proved yet issues:
1) why the first gives us the minimal partition? 2) bottleneck  = the maximal error, $\varepsilon$.
\end{document}

